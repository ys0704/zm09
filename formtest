from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
import time

# ç°¡å˜ãƒ†ã‚¹ãƒˆç‰ˆ
def test_google_form():
    # ã€ã“ã“ã«ã‚ãªãŸã®Googleãƒ•ã‚©ãƒ¼ãƒ URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‘
    form_url = "https://forms.gle/dLEULnjz5Rii26JV6"
    
    if form_url == "https://forms.gle/dLEULnjz5Rii26JV6":
        print("âŒ form_urlã‚’å®Ÿéš›ã®Googleãƒ•ã‚©ãƒ¼ãƒ URLã«å¤‰æ›´ã—ã¦ãã ã•ã„ï¼")
        return
    
    # ChromeDriverã®è‡ªå‹•è¨­å®š
    print("ğŸš€ ChromeDriverã‚’æº–å‚™ä¸­...")
    options = webdriver.ChromeOptions()
    # options.add_argument('--headless')  # ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
    service = Service(ChromeDriverManager().install())
    driver = webdriver.Chrome(service=service, options=options)
    
    try:
        print("ğŸ“‹ ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã„ã¦ã„ã¾ã™...")
        driver.get(form_url)
        time.sleep(3)
        
        print("ğŸ” ãƒ•ã‚©ãƒ¼ãƒ æ§‹é€ ã‚’åˆ†æä¸­...")
        
        # ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ¢ã™
        text_inputs = driver.find_elements(By.CSS_SELECTOR, "input[type='text'], input[type='email']")
        print(f"âœ… ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: {len(text_inputs)}å€‹è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ")
        
        # ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚’æ¢ã™
        textareas = driver.find_elements(By.TAG_NAME, "textarea")
        print(f"âœ… ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢: {len(textareas)}å€‹è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ")
        
        # ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’æ¢ã™
        radio_groups = driver.find_elements(By.CSS_SELECTOR, "div[role='radiogroup']")
        print(f"âœ… ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ—: {len(radio_groups)}å€‹è¦‹ã¤ã‹ã‚Šã¾ã—ãŸ")
        
        # å®Ÿéš›ã«1ã¤ç›®ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›ã—ã¦ã¿ã‚‹
        if text_inputs:
            print("ğŸ“ 1ç•ªç›®ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ†ã‚¹ãƒˆå…¥åŠ›...")
            text_inputs[0].clear()
            text_inputs[0].send_keys("ãƒ†ã‚¹ãƒˆå¤ªéƒ")
            print("âœ… å…¥åŠ›å®Œäº†ï¼")
        
        # 2ã¤ç›®ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Œã°å…¥åŠ›
        if len(text_inputs) > 1:
            print("ğŸ“ 2ç•ªç›®ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ†ã‚¹ãƒˆå…¥åŠ›...")
            text_inputs[1].clear()
            text_inputs[1].send_keys("test@example.com")
            print("âœ… å…¥åŠ›å®Œäº†ï¼")
        
        print("\nğŸ‰ ãƒ†ã‚¹ãƒˆå®Œäº†ï¼ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ‰‹å‹•ã§ç¢ºèªã—ã¦ãã ã•ã„")
        print("â° 10ç§’å¾Œã«è‡ªå‹•ã§é–‰ã˜ã¾ã™...")
        time.sleep(10)
        
    except Exception as e:
        print(f"âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        print("ğŸ’¡ ãƒ•ã‚©ãƒ¼ãƒ URLãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„")
    
    finally:
        driver.quit()
        print("ğŸ”š ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¾ã—ãŸ")

if __name__ == "__main__":
    print("ğŸ¤– Googleãƒ•ã‚©ãƒ¼ãƒ è‡ªå‹•å…¥åŠ›ãƒ†ã‚¹ãƒˆé–‹å§‹")
    print("=" * 50)
    test_google_form()